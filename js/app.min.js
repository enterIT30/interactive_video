
const body = document.querySelector('body');
const videoBlock = document.querySelector('.video-block');
const btnCross = document.querySelector('.video-cross');
const btnFullScreen = document.querySelector('.fullscreen');
const btnOrder = document.querySelector('.video-btn');
const video = document.querySelector('.video-video');
const popup = document.querySelector('.popup.popup-order');
const btnClosePopap = document.querySelector('.popup__close');

body.addEventListener('click', e => {
  if (!videoBlock.contains(e.target) && !e.target.closest('.popup.popup-order')) {
    removeAllActivityClasses();
  }
});

videoBlock.addEventListener('click', e => {
  const midleCondition = videoBlock.classList.contains('midle');
  const fullscreenCondition = videoBlock.classList.contains('fullscreen');
  const parentBtnFullScreen = e.target.closest('.video-fullscreen');
  const parentBtnCross = e.target.closest('.video-cross');
  const parentVideo = e.target.closest('.video-video');
  const parentBtnOrder = e.target.closest('.video-btn');

  // MIDLE CONDITION ==================================================================================

  if (parentVideo && midleCondition) {
    if (video.paused) {
      video.play();
      video.muted = false;
    } else {
      video.pause();
    }
  } else if (parentVideo) {
    e.stopPropagation();
    videoBlock.classList.add('midle');
    btnOrder.classList.add('active');
    video.muted = false;
  }

  // CLOSE CROSS ==================================================================================

  if (parentBtnCross && midleCondition) {
    videoBlock.classList.remove('midle');
    btnOrder.classList.remove('active');
    if (video.paused) {
      video.play();
      video.muted = true;
    } else {
      video.muted = true;
    }
  } else if (parentBtnCross && fullscreenCondition) {
    videoBlock.classList.remove('fullscreen');
    videoBlock.classList.add('midle');
  } else if (parentBtnCross) {
    videoBlock.remove();
  }

  // FULLSCREEN CONDITION==================================================================================

  if (parentBtnFullScreen && fullscreenCondition) {
    removeAllActivityClasses();
  } else if (parentBtnFullScreen && midleCondition || parentBtnFullScreen) {
    videoBlock.classList.add('fullscreen');
    videoBlock.classList.remove('midle');
    btnOrder.classList.add('active');
    video.muted = false;
  }

// BTN POPUP OPEN ==================================================================================

  if (parentBtnOrder) {
    popupOpen();
  }
});

// POPUP CLOSE ==================================================================================

popup.addEventListener('click', (e) => {
  if (e.target === btnClosePopap || e.target === popup) {
    popupClose();
  }
});

// POPUP

function popupOpen() {
  popup.classList.add('popup-active');
}
function popupClose() {
  popup.classList.remove('popup-active');
}

// Delete all classes–∞
function removeAllActivityClasses() {
  videoBlock.classList.remove('midle');
  videoBlock.classList.remove('fullscreen');
  btnOrder.classList.remove('active');
  if (video.paused) {
    video.play();
    video.muted = true;
  } else {
    video.muted = true;
  }
}




